name: Legacy CI/CD (Manual)

on:
  workflow_dispatch:

jobs:
  deprecation-note:
    name: Workflow Notice
    runs-on: ubuntu-latest
    steps:
      - name: Explain workflow status
        run: |
          echo "Automatic CI is handled by .github/workflows/CI.yml"
          echo "Automatic deployment is handled by .github/workflows/CD.yml"
          echo "This legacy workflow remains manual-only for compatibility."

  docker-build-check:
    name: Docker Build Check
    runs-on: ubuntu-latest
    steps:
      - name: Checkout code
        uses: actions/checkout@v4

      - name: Setup Node.js
        uses: actions/setup-node@v4
        with:
          node-version: 20

      - name: Validate env templates
        run: bash infrastructure/scripts/ci/validate-env-templates.sh

      - name: Set up Docker Buildx
        uses: docker/setup-buildx-action@v3

      - name: Build image using infrastructure Dockerfile
        uses: docker/build-push-action@v5
        with:
          context: .
          file: ./infrastructure/Dockerfile
          push: false
          load: false
